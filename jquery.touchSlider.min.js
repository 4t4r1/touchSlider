(function(a){a.fn.reverse=[].reverse;a.fn.touchSlider=function(b){var b=a.extend({item:"div.item",holder:"div.holder",box:"div.list",debug:false,mode:"shift",shift:"80%",delta:40,single:false,center:false,animation:"auto",touch:true,duration:500,prevLink:null,nextLink:null,onChange:null,onStart:null,onCheckItems:null,lockScroll:false,hideClass:"mt-hidden",activeClass:"active"},b);this.each(function(){var s=jQuery(this);if(b.debug){a("body").append('<div id="console"></div>')}var H=[{start:"mousedown",end:"mouseup",move:"mousemove",leave:"mouseout"},{start:"touchstart",end:"touchend",move:"touchmove",leave:"touchend"}];var P="ontouchend" in document?1:0;var B=a(b.item,this);if(!B.length){return}var Y=a(b.holder,this).first();if(!Y.length){return}var n=a(b.box,this).first();if(!n.length){return}var x=false;if(b.animation&&b.animation!="js"){var E=document.body||document.documentElement;var V=E.style;var aa=(V.WebkitTransition!==undefined)?"webkitTransitionEnd":"transitionend";x=V.WebkitTransition!==undefined||V.MozTransition!==undefined||V.transition!==undefined;if(x&&b.animation=="auto"){F("Detected Transitions Support","");n.css({"-webkit-transition-property":"-webkit-transform","-webkit-transition-timing-function":"ease","-moz-transition-property":"-moz-transform","-moz-transition-timing-function":"ease","transition-property":"transform","transition-timing-function":"ease"});n.unbind(aa);n.bind(aa,L)}var S=("WebKitCSSMatrix" in window&&"m11" in new WebKitCSSMatrix());if(S){F("Detected 3D Support","")}}var h=null;var e=null;var d=0;var R=[];var u=0;var ac=null;var v=null;var W=0;var t=false;l(0);I(0);if(b.touch){var ab=n.get(0);ab.addEventListener(H[P]["start"],o,false);ab.addEventListener(H[P]["end"],o,false);ab.addEventListener(H[P]["leave"],o,false);ab.addEventListener(H[P]["move"],o,false)}if(b.prevLink){a(b.prevLink,s).bind("click",function(){s.get(0).movePrev();return false})}if(b.nextLink){a(b.nextLink,s).bind("click",function(){s.get(0).moveNext();return false})}window.addEventListener("onorientationchange" in window?"orientationchange":"resize",k,false);window.addEventListener("load",k,false);function k(){setTimeout(g,200)}var J=false;var D=0;var c=Y.width();F("Current width:",c);this.getCount=function(){return b.mode=="auto"?R.length:a(B).length};this.moveNext=function(){switch(b.mode){case"index":y();break;case"shift":j();break;case"auto":w();break}};this.movePrev=function(){switch(b.mode){case"index":r();break;case"shift":M();break;case"auto":p();break}};this.moveTo=function(ae){switch(b.mode){case"index":T(ae);break}};this.refresh=function(){g()};g(true);function g(ae){c=Y.width();W=0;var ae=typeof(ae)=="undefined"?false:ae;if(ae&&a.isFunction(b.onStart)){b.onStart()}switch(b.mode){case"index":if(b.single){var af=0;if(ae){K()}else{a(B[h]).css("width",c);setTimeout(C,100)}Z()}else{if(b.center){Z()}}break;case"shift":X();break;case"auto":R=[];if(b.single){i()}ad("both");B.each(function(ai,aj){var ah=this.offsetWidth;var ag=R.length;if(ai==0){if(ah>c){R.push([ah,new Array(new Array(ai,ah)),0])}else{R.push([ah,new Array(new Array(ai,ah))])}G(ai)}else{if(R[ag-1][0]+ah<=c){R[ag-1][0]+=ah;R[ag-1][1].push(new Array(ai,ah));G(ai)}else{if(ah>c){R.push([ah,new Array(new Array(ai,ah)),0])}else{R.push([ah,new Array(new Array(ai,ah))])}G(ai)}}});if(h>=R.length){l(R.length-1)}if(b.single){O()}if(a.isFunction(b.onCheckItems)){b.onCheckItems()}m();break}}function i(){a(B).css("width","")}function G(ae){if(ae==d){l(R.length-1)}}function K(){a.each(B,function(){a(this).css("width","");var ae=a(this).width();if(ae<c){a(this).css("width",c)}})}function O(){a.each(R,function(ae,af){if(af[0]<c){var ag=af[0];af[0]=c;a(af[1]).each(function(ah,ai){ai[1]=parseInt(c*ai[1]/ag);a(B[ai[0]]).css("width",ai[1])})}})}function C(){K();Z(true)}function o(ae){var af=(P)?ae.touches[0]:ae;switch(ae.type){case H[P]["move"]:q(ae,af);break;case H[P]["start"]:U(ae,af);break;case H[P]["end"]:case H[P]["leave"]:A(ae);break}}function q(ae,af){if(J){if(b.lockScroll&&ae.type!="click"){ae.preventDefault()}W=D-af.pageX;if(W!=0){f(e-W,true)}}}function U(ae,af){if(!J){t=false;F("Touch Start");J=true;W=0;D=(P)?af.pageX:ae.clientX}}function A(ae,af){if(J){F("Touch End");J=false;D=0;if(W!=0){if(W>b.delta||W<(0-b.delta)){N()}else{f(e)}}}W=0}function N(){switch(b.mode){case"shift":X();break;case"index":Z();break;case"auto":m();break}}function Z(ae){var ah=0;var ag=0;a.each(B,function(ai){if(ai<h){ag+=this.offsetWidth}ah+=this.offsetWidth});if(ah<=c){z("both");return}else{ad("both")}var af=0;if(W>0){if(b.center){af=0-(ag+a(B[h]).width()+a(B[h+1]).width()/2)+c/2;if(h<B.length-1){l(h+1);I(af);f(e)}else{f(e)}}else{af=0-(ag+a(B[h]).width());if(ah+af>c){l(h+1);I(af);f(e)}else{l(B.length-1);I(0-(ah-c));f(e)}}}else{if(W<0){if(b.center){af=0-(ag-a(B[h-1]).width()/2)+c/2;if(h>0){l(h-1);I(af);f(e)}else{f(e)}}else{af=0-(ag-a(B[h]).width());if(af<0){l(h-1);I(af);f(e)}else{l(0);I(0);f(e)}}}else{if(b.center){af=0-(ag+a(B[h]).width()/2)+c/2;I(af);if(typeof(ae)=="undefined"){f(e)}else{f(e,true)}}else{af=0-ag;I(af);if(typeof(ae)=="undefined"){f(e)}else{f(e,true)}}}}}function m(){var ah=0;var ag=0;a.each(R,function(ai){if(ai<h){ag+=this[0]}ah+=this[0]});var af=R[h].length>2?true:false;if(ah<=c){z("both")}else{ad("both")}if(b.center&&ah<c){ae=c/2-ah/2;I(ae);f(e);return}var ae=0;if(W>0){if(h<R.length-1||(h>=R.length-1&&af)){if(af&&R[h][0]-c>R[h][2]){R[h][2]+=c;if(R[h][0]-R[h][2]>c){I(e-c);f(e)}else{I(e-(R[h][0]-R[h][2]));R[h][2]+=R[h][0]-R[h][2];R[h][2]-=c;f(e)}}else{if(typeof(R[h+1])!="undefined"){if(R[h+1].length>2){ae=0-(ag+R[h][0])}else{ae=0-(ag+R[h][0]+R[h+1][0]/2)+c/2}if(ah+ae>c){l(h+1);I(ae);f(e)}else{l(R.length-1);I(0-(ah-c));f(e)}}else{f(e)}}}else{f(e)}}else{if(W<0){if(h>0||(h<=0&&af)){if(af&&R[h][2]>0){R[h][2]-=c;if(R[h][2]>=0){I(e+c);f(e)}else{I(e+(R[h][2]+c));R[h][2]=0;f(e)}}else{if(typeof(R[h-1])!="undefined"){if(R[h-1].length>2){ae=0-(ag-c);R[h-1][2]=R[h-1][0]-c}else{ae=0-(ag-R[h-1][0]/2)+c/2}if(ae<0){l(h-1);I(ae);f(e)}else{l(0);I(0);f(e)}}else{f(e)}}}else{f(e)}}else{if(af){ae=0-ag}else{ae=0-(ag+R[h][0]/2)+c/2}if(ae>=0){I(0);f(e)}else{if(ah+ae<=c){I(0-(ah-c));f(e)}else{I(ae);f(e)}}}}}function z(ae){switch(ae){case"both":if(b.prevLink){a(b.prevLink,s).addClass(b.hideClass)}if(b.nextLink){a(b.nextLink,s).addClass(b.hideClass)}break;case"prev":if(b.prevLink){a(b.prevLink,s).addClass(b.hideClass)}break;case"next":if(b.nextLink){a(b.nextLink,s).addClass(b.hideClass)}break}c=Y.width()}function ad(ae){switch(ae){case"both":if(b.prevLink){a(b.prevLink,s).removeClass(b.hideClass)}if(b.nextLink){a(b.nextLink,s).removeClass(b.hideClass)}break;case"prev":if(b.prevLink){a(b.prevLink,s).removeClass(b.hideClass)}break;case"next":if(b.nextLink){a(b.nextLink,s).removeClass(b.hideClass)}break}c=Y.width()}function X(){var ag=0;a.each(B,function(){ag+=this.offsetWidth});if(ag<c&&!b.center){return}var ae=b.shift+"";var af=0;if(ae.indexOf("%")!=-1){ae=parseInt(c*b.shift.substr(0,b.shift.length-1)/100)}else{ae=parseInt(b.shift)}if(b.center&&ag<c){af=c/2-ag/2;I(af);f(e)}else{if(W>0){af=e-ae;if(ag+af>c){I(af);f(e)}else{I(0-(ag-c));f(e)}}else{af=e+ae;if(af<0){I(af);f(e)}else{I(0);f(e)}}}}function j(){W=1;X()}function M(){W=-1;X()}function F(ag,af){if(typeof(af)=="undefined"){af=""}if(b.debug){var ae=new Date();a("#console").prepend('<div class="debug-item"><strong>'+ae.getMinutes()+":"+ae.getSeconds()+"."+ae.getMilliseconds()+"</strong> "+ag+" "+af+"</div>")}}function l(ae){if(ae!=h){t=true;ac=h;h=ae;if(b.mode=="auto"&&R.length){d=R[h][1][0][0]}else{a(B).removeClass(b.activeClass);a(B[h]).addClass(b.activeClass)}F("Setting up current index:",ae)}else{t=true}}function I(ae){if(ae!=e){v=e;e=ae;F("Setting current offset:",ae)}}function T(ae){if(typeof(B[ae])!="undefined"){l(parseInt(ae));W=0;Z()}}function y(){W=1;Z()}function r(){W=-1;Z()}function w(){W=1;m()}function p(){W=-1;m()}function f(ah,af){var ae=typeof(af)=="undefined"?b.duration:0;if(typeof(af)=="undefined"&&a.isFunction(b.onChange)&&t){b.onChange(ac,h)}if(!b.animation){if(ae){Q();n.css({"margin-left":ah+"px"});L()}}else{Q();var ag=typeof(af)=="undefined"?b.duration/1000+"s":"0";if(x){n.css({"-webkit-transition-duration":ag,"-moz-transition-duration":ag,"transition-duration":ag});if(S){F("CSS 3D Transition To:",ah);n.css({"-webkit-transform":"translate3d("+ah+"px,0,0)",transform:"translate3d("+ah+"px,0,0)"})}else{F("CSS Transition To:",ah);n.css({"-webkit-transform":"translate("+ah+"px,0)","-moz-transform":"translate("+ah+"px,0)",transform:"translate("+ah+"px,0)"})}}else{F("jQuery Animate To:",ah);n.animate({"margin-left":ah+"px"},{queue:false,duration:ae,easing:"swing",complete:L})}}}function Q(){n.addClass("moving");F("Animation start","")}function L(){n.removeClass("moving");F("Animation end","")}});return this}})(jQuery);